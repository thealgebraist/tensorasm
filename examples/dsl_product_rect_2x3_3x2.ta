type Acc = Tensor<f32, {2,2}, TileReg, RowMajor>;
type A = Tensor<f32, {2,3}, Global, RowMajor>;
type B = Tensor<f32, {3,2}, Global, RowMajor>;
type C = Tensor<f32, {2,2}, Global, RowMajor>;

type ATile = Tensor<f32, {2,3}, TileReg, RowMajor>;
type BTile = Tensor<f32, {3,2}, TileReg, RowMajor>;

kernel prodrect(Acc acc, A a, B b, C c) {
  ATile at;
  BTile bt;
  acc = 0;
  LOAD(at, a);
  LOAD(bt, b);
  MMUL(acc, at, bt);
  STORE(c, acc);
  REDUCE(c);
}